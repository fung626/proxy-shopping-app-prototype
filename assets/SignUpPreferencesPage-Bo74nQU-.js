import{u as C,a as S,r as c,j as e,B as p,w as y,t as w}from"./index-CvO9pKPC.js";import{u as E,A as k}from"./useModal-DWtBkeOJ.js";import{B as D}from"./badge-CXoDSUIB.js";import{g}from"./categories-1gq2I0Ze.js";import{C as f}from"./categories-CaJuqvsn.js";import{C as A}from"./check-BygKOcWJ.js";function O(){const{t:a}=C(),i=S(),{showModal:x}=E(),[n,h]=c.useState([]),[t,j]=c.useState(null),[l,m]=c.useState(!1),[d,u]=c.useState("");c.useEffect(()=>{const s=sessionStorage.getItem("signupFormData");if(s)try{const r=JSON.parse(s);j(r)}catch(r){console.error("Error parsing stored form data:",r),i("/auth/signup")}else i("/auth/signup")},[i]);const N=s=>{h(r=>r.includes(s)?r.filter(o=>o!==s):[...r,s])},b=async()=>{if(n.length===0){alert(a("preferences.selectAtLeastOne"));return}if(!t){i("/auth/signup");return}m(!0),u("");try{const s=n.map(o=>f.find(v=>v.id===o)?.translationKey||o),{error:r}=await y.signUp({email:t.email.trim(),password:t.password,firstName:t.firstName.trim(),lastName:t.lastName.trim(),nickname:t.nickname.trim(),phone:t.phone.trim(),countryCode:t.countryCode,gender:t.gender,bio:t.bio.trim(),country:t.country,languages:t.languages,avatar:t.avatar,preferences:s});if(r){x({component:k,props:{title:"common.alert",content:r.message}});return}sessionStorage.removeItem("signupFormData"),w.success(a("auth.signUpSuccess")),i("/auth/signin")}catch(s){console.error("Sign up error:",s),u(s.message||a("auth.signUpFailed"))}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex flex-col",children:e.jsx("div",{className:"flex-1 px-4 py-6 pb-20",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:a("preferences.chooseInterests")}),e.jsx("p",{className:"text-muted-foreground",children:a("preferences.description")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-foreground mb-3",children:[a("preferences.productCategories")," (",n.length," ",a("preferences.selected"),")"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:f.map(s=>{const r=n.includes(s.id),o=s.icon;return e.jsxs(p,{variant:r?"default":"outline",onClick:()=>N(s.id),className:`h-auto py-5 px-3 flex flex-col items-center justify-center text-center relative min-h-[120px] ${r?"bg-primary text-primary-foreground":""}`,children:[r&&e.jsx(A,{className:"absolute top-2 right-2 h-4 w-4"}),e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 ${r?"bg-primary-foreground/20":"bg-red-100"}`,children:e.jsx(o,{className:`h-6 w-6 ${r?"text-primary-foreground":"text-red-600"}`})}),e.jsx("div",{className:"text-sm font-medium",children:g(s.id,a)})]},s.id)})})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-2",children:a("preferences.selectedCategories")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(s=>e.jsx(D,{variant:"secondary",children:g(s,a)},s))})]})]}),d&&e.jsx("div",{className:"mt-4 p-3 bg-red-100 border border-red-300 rounded-md",children:e.jsx("p",{className:"text-red-700 text-sm",children:d})}),e.jsx("div",{className:"mt-8",children:e.jsx(p,{onClick:b,className:"w-full",disabled:n.length===0||l,children:a(l?"common.loading":"preferences.completeSetup")})})]})})})}export{O as SignUpPreferencesPage};
