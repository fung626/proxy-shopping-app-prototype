import{d as B,a as z,u as q,r,j as e,n as C,o as k,B as a}from"./index-CvO9pKPC.js";import{I as R}from"./input-DnWsiyUA.js";import{L as V}from"./label-Cqb5pUVi.js";import{S}from"./switch-CHqSPS1R.js";import{S as m}from"./shield-CXVt-qnW.js";import{C as A}from"./circle-alert-BiEKXxaj.js";import{S as K}from"./smartphone-Cpi-PTj0.js";import{C as p}from"./check-BygKOcWJ.js";import{C as Q}from"./circle-check-big-Dh9XEviq.js";import"./index-BUvxBgzt.js";import"./index-CosQv8v_.js";import"./index-B46UinAq.js";import"./index-wsE_5AEc.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],j=B("copy",_);function te({}){z();const{t:s}=q(),[x,f]=r.useState(!1),[o,c]=r.useState("disabled"),[h,N]=r.useState(""),[b,P]=r.useState([]),[w,g]=r.useState(!1),[v,l]=r.useState(""),[u,n]=r.useState(null),d="JBSWY3DPEHPK3PXP",T=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=otpauth://totp/ProcurementApp:user@example.com?secret=${d}&issuer=ProcurementApp`,D=["1234-5678-9012","3456-7890-1234","5678-9012-3456","7890-1234-5678","9012-3456-7890","2345-6789-0123","4567-8901-2345","6789-0123-4567"],y=()=>{x?(f(!1),c("disabled"),l("")):(c("setup"),l(""))},E=()=>{c("verify")},I=async()=>{if(l(""),h.length!==6){l("Please enter a 6-digit verification code");return}g(!0);try{await new Promise(t=>setTimeout(t,1500)),P(D),f(!0),c("enabled"),N("")}catch{l("Invalid verification code. Please try again.")}finally{g(!1)}},F=async t=>{try{await navigator.clipboard.writeText(t),n(t),setTimeout(()=>n(null),2e3)}catch(i){console.error("Failed to copy text: ",i)}},L=async()=>{const t=b.join(`
`);try{await navigator.clipboard.writeText(t),n("all"),setTimeout(()=>n(null),2e3)}catch(i){console.error("Failed to copy backup codes: ",i)}};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"p-4",children:[o==="disabled"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(m,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:s("twoFactor.secureAccount")}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s("twoFactor.description")}),e.jsxs(C,{className:"mb-6",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs(k,{children:[e.jsxs("strong",{children:[s("twoFactor.recommended"),":"]})," ",s("twoFactor.recommendedText")]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("twoFactor.title")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("twoFactor.currentlyDisabled")})]})]}),e.jsx(S,{checked:x,onCheckedChange:y})]})})]}),o==="setup"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(K,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:s("twoFactor.setupApp")}),e.jsx("p",{className:"text-muted-foreground",children:s("twoFactor.setupDescription")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-border text-center",children:[e.jsx("img",{src:T,alt:"QR Code for 2FA setup",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("twoFactor.scanQR")})]}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:s("twoFactor.manualSetup")}),e.jsxs("div",{className:"flex items-center justify-between bg-background p-3 rounded border",children:[e.jsx("code",{className:"text-sm font-mono",children:d}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>F(d),children:u===d?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:s("twoFactor.setupInstructions")}),e.jsxs("ol",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"w-5 h-5 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-xs font-medium mt-0.5",children:"1"}),e.jsx("span",{children:s("twoFactor.instruction1")})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"w-5 h-5 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-xs font-medium mt-0.5",children:"2"}),e.jsx("span",{children:s("twoFactor.instruction2")})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"w-5 h-5 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-xs font-medium mt-0.5",children:"3"}),e.jsx("span",{children:s("twoFactor.instruction3")})]})]})]}),e.jsx(a,{onClick:E,className:"w-full",children:s("twoFactor.addedAccount")})]})]}),o==="verify"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(m,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:s("twoFactor.verifySetup")}),e.jsx("p",{className:"text-muted-foreground",children:s("twoFactor.verifyDescription")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"verification-code",children:s("twoFactor.verificationCode")}),e.jsx(R,{id:"verification-code",type:"text",value:h,onChange:t=>N(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:s("twoFactor.enterCode"),className:"text-center text-lg tracking-widest",maxLength:6})]}),v&&e.jsxs(C,{variant:"destructive",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(k,{children:v})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(a,{variant:"outline",onClick:()=>c("setup"),className:"flex-1",children:s("common.back")}),e.jsx(a,{onClick:I,disabled:h.length!==6||w,className:"flex-1",children:s(w?"twoFactor.verifying":"twoFactor.verifyAndEnable")})]})]})]}),o==="enabled"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Q,{className:"h-6 w-6 text-green-600"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:s("twoFactor.enabledSuccess")}),e.jsx("p",{className:"text-muted-foreground",children:s("twoFactor.enabledDescription")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:s("twoFactor.backupCodes")}),e.jsxs(a,{variant:"outline",size:"sm",onClick:L,className:"text-yellow-700 border-yellow-300",children:[u==="all"?e.jsx(p,{className:"h-4 w-4 mr-1"}):e.jsx(j,{className:"h-4 w-4 mr-1"}),s("twoFactor.copyAll")]})]}),e.jsx("p",{className:"text-sm text-yellow-700 mb-3",children:s("twoFactor.backupDescription")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.map((t,i)=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border",children:[e.jsx("code",{className:"text-sm font-mono",children:t}),e.jsx(a,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>F(t),children:u===t?e.jsx(p,{className:"h-3 w-3"}):e.jsx(j,{className:"h-3 w-3"})})]},i))})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("twoFactor.title")}),e.jsx("p",{className:"text-sm text-green-600",children:s("twoFactor.currentlyEnabled")})]})]}),e.jsx(S,{checked:x,onCheckedChange:y})]}),e.jsx(a,{className:"w-full",children:s("common.done")})]})]})]})})}export{te as TwoFactorAuthPage};
