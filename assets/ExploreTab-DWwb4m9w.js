import{u,a as f,j as e,B as x,r as n,b as D,c as E}from"./index-CvO9pKPC.js";import{u as h}from"./wishlistStore-CfNM5_Pj.js";import{C as $}from"./categories-CaJuqvsn.js";import{g as A}from"./categories-1gq2I0Ze.js";import{O as j}from"./OfferCard-Bdyy8poT.js";import{B as g}from"./badge-CXoDSUIB.js";import{I as T}from"./ImageWithFallback--6Rpc7vq.js";import{H as N}from"./heart-DlE89daf.js";import{o as w}from"./offersSupabaseService-BThdOnLG.js";import{r as S}from"./requestsSupabaseService-soQQ1D_i.js";import{g as v}from"./common-Dk-gsxo2.js";import{A as O}from"./AgentCard-eIbp_RsA.js";import{S as B}from"./search-B_nDvCvE.js";import"./chatSupabaseService-C5-xj_cv.js";import"./avatar-BW8CM_Dc.js";import"./index-B46UinAq.js";import"./index-BS1Kyr__.js";import"./index-BUvxBgzt.js";import"./circle-check-big-Dh9XEviq.js";import"./star-B1prMbWQ.js";import"./map-pin-BzPRdFpW.js";import"./clock-BGCf1Cg4.js";const L=()=>{const{t:a}=u(),s=f();return e.jsxs("section",{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{children:a("explore.popularCategories")})}),e.jsx("div",{className:"overflow-x-auto scrollbar-hide",children:e.jsx("div",{className:"flex space-x-3 pb-2",children:$.map(l=>{const r=l.icon;return e.jsxs("button",{onClick:()=>s(`/explore/category/${l.id}`),className:"flex-shrink-0 p-3 rounded-xl bg-muted/50 hover:bg-muted/70 transition-colors text-center w-28 h-28",children:[e.jsx("div",{className:"w-16 h-16 rounded-full mb-2 bg-primary/10 flex items-center justify-center mx-auto",children:e.jsx(r,{})}),e.jsx("p",{className:"font-medium text-xs leading-tight line-clamp-1",children:A(l.id,a)})]},l.id)})})})]})},C=({loading:a,request:s})=>{const{t:l}=u(),r=f(),{isWishlistItem:c,toggleWishlistItem:d}=h();return a?e.jsxs("div",{className:"p-3 rounded-xl bg-muted/50 animate-pulse",children:[e.jsx("div",{className:"w-full h-32 rounded-lg bg-muted mb-3"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})]}):e.jsxs("div",{className:"p-3 rounded-xl bg-muted/50 cursor-pointer hover:bg-muted/70 transition-colors",onClick:()=>{s&&r(`/requests/${s.id}`)},children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-full h-32 rounded-lg overflow-hidden",children:e.jsx(T,{src:s?.images?.[0]||"",alt:s?.title,className:"w-full h-full object-cover"})}),e.jsx(x,{size:"sm",variant:"ghost",className:`absolute top-2 right-2 h-8 w-8 p-0 bg-card/80 hover:bg-card rounded-full ${s&&c(s.id)?"text-primary":"text-muted-foreground"}`,onClick:o=>{if(o.stopPropagation(),!!s){d(s.id,"request");try{const t=h.getState();c(s.id)?t.addRemoteItem&&t.addRemoteItem(s.id,"request"):t.removeRemoteItem&&t.removeRemoteItem(s.id)}catch{}}},children:e.jsx(N,{className:`h-4 w-4 ${s&&c(s.id)?"fill-current":""}`})}),e.jsxs(g,{className:"absolute top-2 left-2 text-white text-xs px-2 py-1 bg-blue-600",children:[s?.budget_min," - ",s?.budget_max," ",s?.currency]}),e.jsx(g,{className:"absolute bottom-2 left-2 text-xs px-2 py-1 bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",children:l("common.request")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm line-clamp-2 leading-tight",children:s?.title}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:s?.user_name}),e.jsxs(g,{variant:"secondary",className:"text-xs",children:[s?.expected_delivery?.start," -"," ",s?.expected_delivery?.end," ",s?.expected_delivery?.unit]})]})]})]})},z=()=>{const{t:a}=u(),[s,l]=n.useState(8),[r,c]=n.useState(0),[d,o]=n.useState(!1),[t,_]=n.useState([]);n.useEffect(()=>{(async()=>{try{const[p,k]=await Promise.all([w.getOffers({limit:8,offset:r}),S.getRequests({limit:8,offset:r})]),R=[...p.map(i=>({...i,type:"offer",displayPrice:`${i.price} ${i.currency}`,displayName:i.location||"Offer",displayDelivery:`${i.estimated_delivery?.start||"TBD"} - ${i.estimated_delivery?.end||"TBD"} ${i.estimated_delivery?.type||""}`,image:i.images?.[0]||v(i.category||"default")})),...k.map(i=>({...i,type:"request",displayPrice:`${i.budget_min||0} - ${i.budget_max||0}`,displayName:i.expected_delivery_location||i.designated_purchasing_location||"Request",displayDelivery:i.delivery_method||"TBD",image:v(i.category||"default")}))];_(i=>[...i,...R])}catch(p){console.error("Error fetching recommendations:",p)}})()},[r]);const I=()=>{o(!0),setTimeout(()=>{c(m=>m+8),o(!1)},500)};return e.jsxs("section",{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{children:a("recommendations.title")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a("recommendations.forYou")})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:t.slice(0,s).map(m=>m.type==="offer"?e.jsx(j,{offer:m},m.id):e.jsx(C,{request:m},m.id))}),s<t.length&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx(x,{variant:"outline",onClick:I,disabled:d,className:"px-8 py-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-muted-foreground border-t-transparent rounded-full animate-spin mr-2"}),a("recommendations.loading")]}):a("recommendations.loadMore")})})]})},b=6,P=()=>{const{t:a}=u(),s=f(),[l,r]=n.useState(!1),[c,d]=n.useState([]);return n.useEffect(()=>{(async()=>{r(!0);try{const t=await S.getTrendingRequests(b);d(t)}catch(t){console.error("Error fetching data:",t)}finally{r(!1)}})()},[]),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{children:a("explore.requestsForYou")}),e.jsx(x,{variant:"ghost",size:"sm",className:"text-primary",onClick:()=>s("/explore/all-requests"),children:a("explore.viewAll")})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:l?Array.from({length:b}).map((o,t)=>e.jsxs("div",{className:"p-3 rounded-xl bg-muted/50 animate-pulse",children:[e.jsx("div",{className:"w-full h-32 rounded-lg bg-muted mb-3"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})]},t)):c.map(o=>e.jsx(C,{request:o},o.id))})]})},y=8,W=()=>{const{t:a}=u(),s=f(),[l,r]=n.useState(!1),[c,d]=n.useState([]);return n.useEffect(()=>{(async()=>{r(!0);try{const t=await w.getTrendingOffers(y);d(t)}catch(t){console.error("Error fetching data:",t)}finally{r(!1)}})()},[]),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{children:a("explore.topOffers")}),e.jsx(x,{variant:"ghost",size:"sm",className:"text-primary",onClick:()=>s("/explore/all-offers"),children:a("explore.viewAll")})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:l?Array.from({length:y}).map((o,t)=>e.jsx(j,{loading:!0},t)):c.map(o=>e.jsx(j,{offer:o},o.id))})]})},F=()=>{const{t:a}=u(),s=f(),[l,r]=n.useState(!1),[c,d]=n.useState([]);return n.useEffect(()=>{(async()=>{r(!0);try{const t=await D.getUsers(4);d(t)}catch(t){console.error("Error fetching data:",t)}finally{r(!1)}})()},[]),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{children:a("explore.topRatedAgents")}),e.jsx(x,{variant:"ghost",size:"sm",className:"text-primary",onClick:()=>s("/explore/all-agents"),children:a("explore.viewAll")})]}),e.jsx("div",{className:"space-y-3",children:c.map((o,t)=>e.jsx(O,{index:t,loading:l,item:o},o.id))})]})};function de(){const{t:a}=u(),s=f(),{getWishlistCount:l}=h(),{user:r}=E();return n.useEffect(()=>{if(r)try{h.getState().fetchRemoteWishlist()}catch(c){console.warn("Failed to fetch remote wishlist",c)}},[r]),e.jsxs("div",{className:"flex-1 bg-background pb-[74px]",children:[e.jsxs("div",{className:"bg-card px-4 pt-12 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-semibold text-foreground",children:a("nav.explore")}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(x,{variant:"ghost",size:"icon",onClick:()=>s("/explore/wishlist"),className:"relative rounded-full h-10 w-10",children:[e.jsx(N,{className:`h-6 w-6 ${l()>0?"text-primary fill-current":"text-muted-foreground"}`}),l()>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:l()})})]})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(B,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground pointer-events-none z-10"}),e.jsx(x,{variant:"ghost",onClick:()=>s("/explore/search"),className:"w-full h-12 pl-10 pr-4 bg-input-background border-0 rounded-lg text-muted-foreground hover:bg-input-background/70 transition-colors justify-start font-normal",children:a("explore.searchPlaceholder")})]})]}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsx(L,{}),e.jsx(W,{}),e.jsx(P,{}),e.jsx(F,{}),e.jsx(z,{})]})]})}export{de as ExploreTab};
