import{j as e,r as d,u as T,a as F,h as z,c as R,P as p,B as f,A as U,U as H,M as q,b as K}from"./index-CvO9pKPC.js";import{I as W}from"./ImageWithFallback--6Rpc7vq.js";import{A as G}from"./avatar-BW8CM_Dc.js";import{B as w}from"./badge-CXoDSUIB.js";import{h as Z,E as V,Z as J}from"./moment-DDfV1m0i.js";import{S as h}from"./separator-raDU85jk.js";import{c as Q}from"./chatSupabaseService-C5-xj_cv.js";import{o as X}from"./offersSupabaseService-BThdOnLG.js";import{o as Y}from"./ordersSupabaseService-C1vKZQTj.js";import{a as ee}from"./common-Dk-gsxo2.js";import{S as a}from"./skeleton-D4u7SwtH.js";import{M as se}from"./map-pin-BzPRdFpW.js";import{C as y}from"./clock-BGCf1Cg4.js";import{S as D}from"./shield-CXVt-qnW.js";import{S as ae,C as u}from"./share-2-A74Lo1Si.js";import{H as te}from"./heart-DlE89daf.js";import{S as re}from"./star-B1prMbWQ.js";import{T as ie}from"./truck-BV3tXDUF.js";import"./index-B46UinAq.js";import"./index-BS1Kyr__.js";import"./index-BUvxBgzt.js";function le(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 z-20 flex items-center justify-between p-4 safe-area-inset-top",children:[e.jsx(a,{className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(a,{className:"w-10 h-10 rounded-full"}),e.jsx(a,{className:"w-10 h-10 rounded-full"})]})]}),e.jsxs("div",{className:"aspect-[4/3] bg-muted",children:[e.jsx(a,{className:"w-full h-full"}),e.jsx("div",{className:"absolute bottom-4 right-4",children:e.jsx(a,{className:"w-16 h-6 rounded-full"})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:[1,2,3,4].map((n,s)=>e.jsx(a,{className:"w-2 h-2 rounded-full"},s))})]})]}),e.jsxs("div",{className:"px-4 pb-40",children:[e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(a,{className:"h-8 w-2/3"}),e.jsx(a,{className:"h-6 w-20 rounded-full"})]}),e.jsx(a,{className:"h-4 w-1/2 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(a,{className:"h-4 w-24"}),e.jsx(a,{className:"h-4 w-20"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[1,2,3,4,5].map((n,s)=>e.jsx(a,{className:"h-6 w-16 rounded-full"},s))})]}),e.jsx("div",{className:"border-t border-border my-6"}),e.jsxs("div",{className:"py-6",children:[e.jsx(a,{className:"h-6 w-32 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(a,{className:"w-16 h-16 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(a,{className:"h-4 w-16"}),e.jsx(a,{className:"h-4 w-20"}),e.jsx(a,{className:"h-4 w-24"})]}),e.jsx(a,{className:"h-3 w-40"})]})]})]}),e.jsx("div",{className:"border-t border-border my-6"}),e.jsxs("div",{className:"py-6",children:[e.jsx(a,{className:"h-6 w-32 mb-4"}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map((n,s)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(a,{className:"w-8 h-8 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(a,{className:"h-4 w-32 mb-1"}),e.jsx(a,{className:"h-3 w-48"})]})]},s))})]}),e.jsx("div",{className:"border-t border-border my-6"}),e.jsxs("div",{className:"py-6",children:[e.jsx(a,{className:"h-6 w-40 mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{className:"h-4 w-full"}),e.jsx(a,{className:"h-4 w-full"}),e.jsx(a,{className:"h-4 w-3/4"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(a,{className:"h-4 w-4 rounded"}),e.jsx(a,{className:"h-4 w-20"})]}),e.jsx(a,{className:"h-3 w-32"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(a,{className:"h-4 w-4 rounded"}),e.jsx(a,{className:"h-4 w-24"})]}),e.jsx(a,{className:"h-3 w-28"})]})]})]}),e.jsx(a,{className:"h-4 w-20"})]})]}),e.jsx("div",{className:"border-t border-border my-6"}),e.jsxs("div",{className:"py-6",children:[e.jsx(a,{className:"h-6 w-32 mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{className:"h-4 w-40"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:[1,2,3,4,5].map((n,s)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(a,{className:"h-4 w-4 rounded mt-0.5"}),e.jsx(a,{className:"h-4 flex-1"})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{className:"h-4 w-36"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:[1,2,3].map((n,s)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(a,{className:"h-4 w-4 rounded mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(a,{className:"h-4 w-32 mb-1"}),e.jsx(a,{className:"h-3 w-48"})]})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(a,{className:"h-4 w-28"}),e.jsx("div",{className:"p-4 rounded-lg bg-muted/50 border",children:e.jsxs("div",{className:"space-y-2",children:[[1,2,3].map((n,s)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx(a,{className:"h-4 w-32"}),e.jsx(a,{className:"h-4 w-16"})]},s)),e.jsx("div",{className:"border-t border-border my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(a,{className:"h-4 w-28"}),e.jsx(a,{className:"h-4 w-20"})]}),e.jsx(a,{className:"h-3 w-full mt-2"})]})})]})]})]}),e.jsx("div",{className:"border-t border-border my-6"}),e.jsxs("div",{className:"py-6",children:[e.jsx(a,{className:"h-6 w-40 mb-4"}),e.jsx("div",{className:"grid grid-cols-3 gap-4 p-4 rounded-lg bg-muted/30",children:[1,2,3].map((n,s)=>e.jsxs("div",{className:"text-center",children:[e.jsx(a,{className:"h-6 w-12 mx-auto mb-1"}),e.jsx(a,{className:"h-3 w-16 mx-auto"})]},s))})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border safe-area-inset-bottom",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-baseline space-x-1 mb-1",children:[e.jsx(a,{className:"h-6 w-20"}),e.jsx(a,{className:"h-4 w-10"})]}),e.jsx(a,{className:"h-3 w-48"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(a,{className:"flex-1 h-12 rounded-lg"}),e.jsx(a,{className:"flex-1 h-12 rounded-lg"})]})]})})]})}const $e=d.memo(function(){const{t:s}=T(),o=F(),{id:m}=z(),{user:c}=R(),[t,k]=d.useState(null),[l,S]=d.useState(null),[N,j]=d.useState(!1),[_,C]=d.useState(!1),[ce,de]=d.useState(0),[g,I]=d.useState(!1),[v,b]=d.useState(!1);d.useEffect(()=>{const r=()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})};setTimeout(()=>{r()},100)},[]),d.useEffect(()=>{(async()=>{if(m){j(!0);try{const i=await X.getOfferById(m);if(i){k(i);const x=await K.getUserById(i.user_id);x&&S({...x})}}catch(i){console.error("Error fetching offer data:",i)}finally{j(!1)}}})()},[m]);const $=[{icon:se,title:s("offerDetails.shoppingLocation"),description:`${t?.location||s("common.unknown")} • ${t?.shopping_location||s("offerDetails.variousLocations")}`},{icon:y,title:s("offerDetails.deliveryTime"),description:`${`${t?.estimated_delivery?.start} - ${t?.estimated_delivery?.end} ${t?.estimated_delivery?.type}`||s("common.tbd")} • ${t?.processing_time||s("offerDetails.defaultProcessing")} ${s("offerDetails.processing")}`},{icon:p,title:s("common.category"),description:s(`categories.${t?.category}`)||s("common.general")},{icon:D,title:s("offerDetails.authenticity"),description:s("offerDetails.authenticityGuarantee")}],A=ee(t?.currency),O=()=>{o(-1)},B=async()=>{if(!c||!t?.user_id||!m){if(!c){o("/auth/signin");return}return}if(c.id!==t.user_id){b(!0);try{const r=await Q.getOrCreateConversation({participant_user_id:t.user_id,offer_id:m});r?o(`/messages/chat/${r.id}`):console.error("Failed to create conversation")}catch(r){console.error("Error contacting agent:",r)}finally{b(!1)}}},L=async()=>{if(!c||!t){if(!c){o("/auth/signin");return}return}const r={fullName:c.user_metadata?.full_name||c.email||"Customer",phone:c.user_metadata?.phone||"",street:"",addressLine2:"",city:"",state:"",postalCode:"",country:t.location||"HK"};j(!0);try{const i={agentUserId:t.user_id,clientUserId:c.id,offerId:t.id,currency:t.currency||"HKD",deliveryMethod:"personal_handoff",expectedMeetingLocation:t.location||"Hong Kong",deliveryAddress:r,paymentMethod:"credit_card",items:[{productName:t.title,productDescription:t.description||"",productImageUrl:t.images?.[0]||"",quantity:1,unitPrice:t.price||0,offerId:t.id}]},x=await Y.createOrder(i);x?o(`/orders/${x.id}`):console.error("Failed to create order")}catch(i){console.error("Error creating order:",i)}finally{j(!1)}},M=()=>{console.log("Share offer:",t?.id)};if(N)return e.jsx(le,{});const P=[s("offerDetails.professionalShoppingService"),s("offerDetails.productAuthenticityVerification"),s("offerDetails.securePackagingHandling"),s("offerDetails.realTimeOrderUpdates"),s("offerDetails.qualityInspectionBeforeShipping")],E=l?.created_at?Z(l.created_at).fromNow():s("common.unknown");return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 z-30 flex items-center justify-between p-4 safe-area-inset-top",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:O,className:"bg-white/90 backdrop-blur-sm hover:bg-white rounded-full shadow-lg",children:e.jsx(U,{className:"h-5 w-5 text-gray-900"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{variant:"ghost",size:"icon",onClick:M,className:"bg-white/90 backdrop-blur-sm hover:bg-white rounded-full shadow-lg",children:e.jsx(ae,{className:"h-5 w-5 text-gray-900"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>I(!g),className:"bg-white/90 backdrop-blur-sm hover:bg-white rounded-full shadow-lg",children:e.jsx(te,{className:`h-5 w-5 ${g?"fill-primary text-primary":"text-gray-900"}`})})]})]}),e.jsx("div",{className:"aspect-[4/3]",children:e.jsx(V,{slides:t?.images||[]})})]}),e.jsxs("div",{className:"px-4 pb-40",children:[e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground pr-4",children:t?.title||"Product"}),t?.availability==="In Stock"&&e.jsxs(w,{className:"bg-green-500 text-white",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),s("offerDetails.available")]})]}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:[t?.category?s(`categories.${t.category}`):s("common.general")," ","•"," ",t?.location||s("offerDetails.variousLocations")]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsxs("span",{children:[s("offerDetails.updated")," ",s("common.recently")]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsxs("span",{children:["0 ",s("offerDetails.ordersCompleted")]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:(t?.tags||[]).map((r,i)=>e.jsxs(w,{variant:"secondary",className:"text-xs",children:["#",r]},i))})]}),e.jsx(h,{}),e.jsxs("div",{className:"py-6",children:[e.jsxs("h3",{className:"font-semibold mb-4",children:[s("offerDetails.offeredBy")," ",l?.nickname]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(G,{className:"flex items-center justify-center w-16 h-16 bg-slate-50",children:l?.image?e.jsx(W,{src:l?.image,alt:l?.nickname||"Agent Avatar",className:"w-full h-full object-cover"}):e.jsx(H,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(re,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium",children:l?.rating||s("offerDetails.noRatings")})]}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx("span",{className:"text-muted-foreground",children:`${l?.reviews??0} ${s("common.reviews")}`||s("common.noReviews")}),l?.verified&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(u,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-green-600 text-sm",children:s("common.verified")})]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:`${s("common.memberSince")} ${E} • ${l?.success_rate??0}% ${s("offerDetails.successRate")}`})]})]})]}),e.jsx(h,{}),e.jsxs("div",{className:"py-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:s("offerDetails.offerDetails")}),e.jsx("div",{className:"space-y-4",children:$.map((r,i)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:e.jsx(r.icon,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.description})]})]},i))})]}),e.jsx(h,{}),e.jsxs("div",{className:"py-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:s("offerDetails.aboutThisOffer")}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-foreground leading-relaxed",children:t?.description||"Our experienced shopping agent will carefully source and purchase the requested items for you. We specialize in finding authentic, high-quality products while providing excellent customer service throughout the entire shopping process."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"p-3 rounded-lg offer-details-authenticity-box",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(D,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium offer-details-authenticity-text",children:s("offerDetails.authenticity")})]}),e.jsx("p",{className:"text-xs offer-details-authenticity-subtext",children:s("offerDetails.authenticityGuarantee")})]}),e.jsxs("div",{className:"p-3 rounded-lg offer-details-fast-shipping-box",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(ie,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium offer-details-fast-shipping-text",children:s("offerDetails.fastShipping")})]}),e.jsx("p",{className:"text-xs offer-details-fast-shipping-subtext",children:s("offerDetails.expressDelivery")})]})]})]})})]}),e.jsx(h,{}),e.jsxs("div",{className:"py-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:s("offerDetails.whatsIncluded")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:s("offerDetails.serviceInclusions")}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:P.map((r,i)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(u,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm leading-relaxed",children:r})]},i))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:s("offerDetails.additionalBenefits")}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(u,{className:"h-4 w-4 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s("offerDetails.freeCommunication")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s("offerDetails.freeCommunicationDesc")})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(u,{className:"h-4 w-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s("offerDetails.purchaseReceipt")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s("offerDetails.purchaseReceiptDesc")})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(u,{className:"h-4 w-4 text-purple-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s("offerDetails.trackingInformation")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s("offerDetails.trackingInformationDesc")})]})]})]})]})]})]}),e.jsx(h,{}),e.jsxs("div",{className:"py-6",children:[e.jsxs("h3",{className:"font-semibold mb-4",children:[l?.nickname,s("offerDetails.agentStats")]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:l?.total_orders??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s("common.orders")})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-foreground",children:[l?.success_rate??0,"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s("common.successRate")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:l?.rating??0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s("common.rating")})]})]})]})]}),_&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4",children:[e.jsx("button",{onClick:()=>C(!1),className:"absolute top-4 right-4 text-white hover:text-gray-300 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"max-w-4xl max-h-full"})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border safe-area-inset-bottom",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-baseline space-x-1",children:[e.jsxs("span",{className:"text-xl font-semibold text-foreground",children:[A,t?.price||"0.00"]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s("common.total")})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("offerDetails.allFeesIncluded")})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(f,{variant:"outline",onClick:B,className:"flex-1",disabled:v||!t?.user_id||t.agent_id===c?.id,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),s(v?"common.loading":"offerDetails.contactAgent")]}),e.jsxs(f,{onClick:L,className:"flex-1",disabled:N||!t||t.agent_id===c?.id,children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),s("offerDetails.orderNow")]})]})]})})]})});export{$e as OfferDetailsPage};
