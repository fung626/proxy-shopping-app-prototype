import{u as h,a as j,r as s,j as r,P as b}from"./index-CvO9pKPC.js";import{O as p}from"./OfferCard-Bdyy8poT.js";import{R as v}from"./RequestCardB-5Jaff5AR.js";import{I as y}from"./input-DnWsiyUA.js";import{o as N}from"./offersSupabaseService-BThdOnLG.js";import{r as S}from"./requestsSupabaseService-soQQ1D_i.js";import{S as q}from"./search-B_nDvCvE.js";import"./badge-CXoDSUIB.js";import"./wishlistStore-CfNM5_Pj.js";import"./ImageWithFallback--6Rpc7vq.js";import"./heart-DlE89daf.js";import"./common-Dk-gsxo2.js";import"./map-pin-BzPRdFpW.js";function _(){const{t:o}=h();j();const m=s.useRef(null),[a,f]=s.useState(""),[g,c]=s.useState(!1),[w,i]=s.useState(""),[l,x]=s.useState({title:"",description:"",requests:[],offers:[]}),n=s.useCallback(async()=>{c(!0),i("");try{const e=await S.getRequests({}),t=await N.getOffers({});x({title:o("explore.searchPlaceholder"),description:"",requests:e,offers:t})}catch(e){console.error("Error fetching data:",e),i("Failed to fetch data. Please try again later.")}finally{c(!1)}},[o]);s.useEffect(()=>{n()},[n]);const u=s.useMemo(()=>[...l.requests.map(e=>({...e,type:"request"})),...l.offers.map(e=>({...e,type:"offer",price:e.price||0}))],[l]),d=s.useMemo(()=>{let e=u;return a.trim()&&(e=e.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())||t.description?.toLowerCase().includes(a.toLowerCase()))),e},[u,a]);return r.jsxs("div",{className:"flex-1 bg-background pb-[74px]",children:[r.jsx("div",{className:"px-4 pt-4 pb-4",children:r.jsxs("div",{className:"relative",children:[r.jsx(q,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),r.jsx(y,{ref:m,value:a,onChange:e=>f(e.target.value),placeholder:o("explore.searchPlaceholder"),className:"pl-10 pr-4 bg-input-background border-0 rounded-lg text-foreground placeholder:text-muted-foreground"})]})}),r.jsx("div",{className:"px-4 py-6",children:g?r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:12}).map((e,t)=>r.jsx(p,{loading:!0},t))}):r.jsx(r.Fragment,{children:d.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(b,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:o("common.noItemsFound")})]}):r.jsx("div",{className:"grid grid-cols-2 gap-3",children:d.map(e=>e.type==="request"?r.jsx(v,{request:e},e.id):r.jsx(p,{offer:e},e.id))})})})]})}export{_ as SearchPage};
