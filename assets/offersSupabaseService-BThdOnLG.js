import{s as c}from"./index-CvO9pKPC.js";class n{async getOffers(e){try{let r=c.from("offers").select("*");e?.name&&(r=r.ilike("title",`%${e.name}%`)),e?.description&&(r=r.ilike("description",`%${e.description}%`)),e?.category&&(r=r.eq("category",e.category)),e?.location&&(r=r.ilike("location",`%${e.location}%`)),e?.priceMin&&(r=r.gte("price",e.priceMin)),e?.priceMax&&(r=r.lte("price",e.priceMax)),e?.status&&(r=r.eq("status",e.status)),e?.limit&&(r=r.limit(e.limit)),e?.offset&&(r=r.range(e.offset,e.offset+(e.limit||10)-1)),r=r.order("created_at",{ascending:!1});const{data:o,error:t}=await r;if(t)throw console.error("Error fetching offers:",t),t;return o||[]}catch(r){throw console.error("Error in getOffers:",r),r}}async getTrendingOffers(e=4){try{const{data:r,error:o}=await c.from("offers").select("*").limit(e).order("created_at",{ascending:!1});if(o)throw console.error("Error fetching trending offers:",o),o;return r||[]}catch(r){throw console.error("Error in getTrendingOffers:",r),r}}async getOfferById(e){try{const{data:r,error:o}=await c.from("offers").select("*").eq("id",e).single();if(o)throw console.error("Error fetching offer:",o),o;return r}catch(r){throw console.error("Error in getOfferById:",r),r}}async getOfferByIds(e){try{const{data:r,error:o}=await c.from("offers").select("*").in("id",e);if(o)throw console.error("Error fetching offers by IDs:",o),o;return r||[]}catch(r){throw console.error("Error in getOfferByIds:",r),r}}async createOffer(e){try{const r=new Date().toISOString(),o={user_id:e.user_id,title:e.title,description:e.description,category:e.category,price:e.price,currency:e.currency||"USD",location:e.location,shopping_location:e.shopping_location||e.location,available_quantity:e.available_quantity||1,estimated_delivery:e.estimated_delivery,specifications:e.specifications||[],tags:e.tags||[],delivery_options:e.delivery_options||[],images:e.images||[],status:e.status||"active",created_at:r,updated_at:r},{data:t,error:i}=await c.from("offers").insert([o]).select().single();if(i)throw console.error("Error creating offer:",i),i;return t}catch(r){throw console.error("Error in createOffer:",r),r}}async updateOffer(e,r){try{const{data:o,error:t}=await c.from("offers").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(t)throw console.error("Error updating offer:",t),t;return o}catch(o){throw console.error("Error in updateOffer:",o),o}}async deleteOffer(e){try{const{error:r}=await c.from("offers").delete().eq("id",e);if(r)throw console.error("Error deleting offer:",r),r;return!0}catch(r){throw console.error("Error in deleteOffer:",r),r}}async getOffersByCategory(e,r){try{let o=c.from("offers").select("*").eq("category",e).order("created_at",{ascending:!1});r&&(o=o.limit(r));const{data:t,error:i}=await o;if(i)throw console.error("Error fetching offers by category:",i),i;return t||[]}catch(o){throw console.error("Error in getOffersByCategory:",o),o}}async getOffersByUser(e){try{const{data:r,error:o}=await c.from("offers").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(o)throw console.error("Error fetching offers by user:",o),o;return r||[]}catch(r){throw console.error("Error in getOffersByUser:",r),r}}async searchOffers(e,r){try{let o=c.from("offers").select("*").or(`title.ilike.%${e}%,description.ilike.%${e}%`);r?.category&&(o=o.eq("category",r.category)),r?.location&&(o=o.ilike("location",`%${r.location}%`)),r?.priceMin&&(o=o.gte("price",r.priceMin)),r?.priceMax&&(o=o.lte("price",r.priceMax)),r?.limit&&(o=o.limit(r.limit)),o=o.order("created_at",{ascending:!1});const{data:t,error:i}=await o;if(i)throw console.error("Error searching offers:",i),i;return t||[]}catch(o){throw console.error("Error in searchOffers:",o),o}}}const f=new n;export{f as o};
