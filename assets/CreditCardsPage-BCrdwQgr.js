import{a as E,u as T,r as c,j as e,B as a}from"./index-CvO9pKPC.js";import{B as P}from"./badge-CXoDSUIB.js";import{D as $,a as A,b as z,c as B,d as I,e as M}from"./dialog-DWMkWXSP.js";import{C as h}from"./credit-card-DAW3eLy7.js";import{P as U}from"./plus-BEKpnawi.js";import{E as F}from"./eye-off-DfQLGFcl.js";import{E as L}from"./eye-CND1pLNp.js";import{T as O}from"./trash-2-BCR9F0r9.js";import"./index-tYtXYGJ5.js";import"./index-CosQv8v_.js";import"./index-B46UinAq.js";import"./Combination-DwCW9mbS.js";import"./index-BUvxBgzt.js";import"./index-BS1Kyr__.js";import"./index-BdAoUvTi.js";import"./x-wt5hBkWR.js";function te({user:d}){const u=E(),{t:r}=T(),[i,o]=c.useState(d?.creditCards||[]);c.useEffect(()=>{d?.creditCards&&o(d.creditCards)},[d?.creditCards]),c.useEffect(()=>{console.log("CreditCardsPage - User:",d),console.log("CreditCardsPage - User creditCards:",d?.creditCards),console.log("CreditCardsPage - Local creditCards state:",i)},[d,i]);const[C,v]=c.useState({}),[f,j]=c.useState(!1),[g,p]=c.useState(""),[m,n]=c.useState(null),b=s=>s.replace(/\s/g,"").replace(/(\d{4})(\d{4})(\d{4})(\d{4})/,"**** **** **** $4"),w=s=>{const t="w-8 h-6 rounded border bg-white flex items-center justify-center text-xs font-bold";switch(s){case"visa":return e.jsx("div",{className:`${t} text-blue-600`,children:"VISA"});case"mastercard":return e.jsx("div",{className:`${t} text-red-600`,children:"MC"});case"amex":return e.jsx("div",{className:`${t} text-green-600`,children:"AMEX"});case"discover":return e.jsx("div",{className:`${t} text-orange-600`,children:"DISC"});default:return e.jsx(h,{className:"w-6 h-6 text-muted-foreground"})}},y=s=>{const t=i.find(x=>x.id===s),l=i.filter(x=>x.id!==s);t?.isDefault&&l.length>0&&(l[0].isDefault=!0),o(l),n(null)},D=s=>{o(t=>t.map(l=>({...l,isDefault:l.id===s})))},S=s=>{v(t=>({...t,[s]:!t[s]}))},k=async()=>{j(!0),p("");try{await new Promise(s=>setTimeout(s,1e3)),console.log("Saving credit cards:",i),u(-1)}catch{p(r("addCreditCard.errorSaveFailed"))}finally{j(!1)}},N=()=>{u("/profile/credit-cards/add")};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(h,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:r("creditCards.subtitle")}),e.jsx("p",{className:"text-muted-foreground",children:r("creditCards.description")})]}),g&&e.jsx("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:e.jsx("p",{className:"text-sm text-destructive",children:g})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:r("creditCards.title")}),e.jsxs(a,{onClick:N,size:"sm",className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:r("creditCards.addNewCard")})]})]}),i.length===0?e.jsxs("div",{className:"p-6 bg-muted/50 rounded-lg text-center",children:[e.jsx(h,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:r("creditCards.noCards")}),e.jsx(a,{onClick:N,children:r("creditCards.addNewCard")})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsxs("div",{className:"p-6 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[w(s.cardType),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-foreground",children:s.nickname||`${s.cardType.charAt(0).toUpperCase()+s.cardType.slice(1)} Card`}),s.isDefault&&e.jsx(P,{variant:"default",className:"text-xs",children:r("creditCards.default")})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:C[s.id]?s.cardNumber:b(s.cardNumber)}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>S(s.id),className:"h-6 w-6 p-0",children:C[s.id]?e.jsx(F,{className:"h-3 w-3"}):e.jsx(L,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!s.isDefault&&e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>D(s.id),className:"text-xs",children:r("creditCards.setAsDefault")}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>n(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(O,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("div",{children:[r("creditCards.expires"),": ",s.expiryMonth,"/",s.expiryYear]}),e.jsxs("div",{children:[r("addCreditCard.cardholderName"),":"," ",s.cardholderName]})]})]},s.id))})]}),e.jsx($,{open:!!m,onOpenChange:()=>n(null),children:e.jsxs(A,{children:[e.jsxs(z,{children:[e.jsx(B,{children:r("creditCards.confirmDelete")}),e.jsx(I,{children:r("creditCards.confirmDeleteMessage")})]}),e.jsxs(M,{className:"space-x-2",children:[e.jsx(a,{variant:"outline",onClick:()=>n(null),children:r("common.cancel")}),e.jsx(a,{variant:"destructive",onClick:()=>m&&y(m),children:r("creditCards.deleteCard")})]})]})}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg my-6",children:[e.jsx("h4",{className:"font-medium mb-2",children:r("addCreditCard.paymentSecurity")}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-600"}),e.jsx("span",{children:r("addCreditCard.security1")})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-600"}),e.jsx("span",{children:r("addCreditCard.security2")})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-600"}),e.jsx("span",{children:r("addCreditCard.security3")})]})]})]}),e.jsx(a,{onClick:k,disabled:f,className:"w-full",children:r(f?"creditCards.saving":"creditCards.saveChanges")})]})})}export{te as CreditCardsPage};
