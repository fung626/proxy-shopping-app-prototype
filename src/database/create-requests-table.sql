
DROP TYPE IF EXISTS delivery_method CASCADE;
DROP TABLE IF EXISTS requests CASCADE;

-- Ensure the `delivery_method` enum type exists (safe: only create when missing)
CREATE TYPE delivery_method AS ENUM (
    'personal_handoff',
    'standard_shipping',
    'express_shipping',
    'same_day_delivery',
    'international_shipping'
);

CREATE TABLE IF NOT EXISTS requests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    user_name TEXT,
    title TEXT NOT NULL,
    description TEXT,
    specific_requirements JSONB,
    category TEXT,
    budget_min NUMERIC(10, 2),
    budget_max NUMERIC(10, 2),
    currency TEXT,
    product_origin TEXT,
    delivery_method delivery_method DEFAULT 'personal_handoff',
    designated_purchasing_location TEXT,
    expected_delivery_location TEXT,
    expected_meeting_location TEXT,
    expected_delivery JSONB,
    shipping_address JSONB,
    images JSONB,
    status TEXT,
    urgency TEXT,
    offers JSONB DEFAULT '[]',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

INSERT INTO "public"."requests" ("id", "user_id", "user_name", "title", "description", "specific_requirements", "category", "budget_min", "budget_max", "currency", "product_origin", "delivery_method", "designated_purchasing_location", "expected_delivery_location", "expected_meeting_location", "expected_delivery", "shipping_address", "images", "status", "urgency", "offers", "created_at", "updated_at") VALUES ('11223344-5566-7788-99aa-bbccddeeff00', '264cb457-c21d-47d0-b56e-1149b958d625', 'Bob Chan', '多功能收納盒', '需要一款多功能的收納盒，用於整理家庭雜物。', '["堅固耐用","多隔層設計","防水材質","可堆疊"]', 'home', '50.00', '120.00', 'HKD', 'cn', 'personal_handoff', 'Guangzhou, China - Storage Solutions Market', 'Hong Kong', 'Hong Kong', '{"end":7,"unit":"days","start":5}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Bob Chan","postalCode":"","addressLine1":"Sha Tin","addressLine2":""}', '["https://img.yec.tw/zp/MerchandiseImages/F447AB90DF-SP-10028911.jpg"]', 'active', 'low', '[]', '2025-11-11 13:00:00+00', '2025-11-11 13:00:00+00'), ('11aabbcc-ddee-1122-3344-556677889900', '01debdb5-7784-439f-870c-37ea485042bc', 'John Doe', '尋找限量版寶可夢卡牌', '我正在尋找來自最新日本系列的稀有寶可夢卡牌。最好是全新狀態和密封包裝。', '["必須是正品","偏好全新狀態","僅密封包裝","日本版本"]', 'toys', '50.00', '300.00', 'HKD', 'jp', 'personal_handoff', 'Tokyo, Japan - Pokémon Center', 'Los Angeles, CA', 'Los Angeles, CA', '{"end":2,"unit":"days","start":1}', '{"city":"Los Angeles","state":"CA","country":"USA","fullName":"John Smith","postalCode":"90210","addressLine1":"123 Main St","addressLine2":"Apt 4B"}', '["https://m.media-amazon.com/images/I/81LqRAY9FIL.jpg","https://rukminim2.flixcart.com/image/480/640/xif0q/card-game/r/y/e/8-pokemo-cards-55-pcs-foil-card-assorted-cards-v-series-black-original-imagpgg7zzpkkusk.jpeg?q=90"]', 'active', 'high', '[]', '2025-10-01 10:00:00+00', '2025-10-01 10:00:00+00'), ('13ad2b5d-babc-4d73-88e6-00d593262ff0', 'e4dc0e2c-7864-4c92-b450-b6dbd87b4071', 'friday626', 'Sony Tps-L2 立體聽 walkman', '音響器材, 可攜式音響設備', '["音響器材","可攜式音響設備"]', 'electronics', '3000.00', '6000.00', 'HKD', 'jp', 'personal_handoff', '香港', '深水埗', null, '{"end":"14","unit":"days","start":"7"}', null, '["https://img.walkman.land/sony/tps-l2/Sony-TPS-L2-01.jpg"]', 'active', 'normal', '[]', '2025-11-15 04:50:07.276+00', '2025-11-15 04:50:07.276+00'), ('22334455-6677-8899-aabb-ccddeeff0011', '01debdb5-7784-439f-870c-37ea485042bc', 'Cathy Lee', '高品質廚房紙巾', '尋找吸水性強且耐用的廚房紙巾，適合日常清潔。', '["吸水性強","耐用","環保材料","大卷裝"]', 'home', '20.00', '50.00', 'HKD', 'cn', 'personal_handoff', 'Beijing, China - Paper Products Market', 'Hong Kong', 'Hong Kong', '{"end":4,"unit":"days","start":2}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Cathy Lee","postalCode":"","addressLine1":"Tuen Mun","addressLine2":""}', '["https://www.pulppy.com/wp-content/uploads/2021/11/TPK0053-Pulppy-3-PLY-Kitchen-Towel-4R-Side.jpg","https://cdn-images.theplace.shop/ThePlace/HKTV-merchant-management-system/uploadProductImage/85ee/7afc/6830/WgTwOYLdhF20241007165824.jpg"]', 'active', 'medium', '[]', '2025-11-11 14:00:00+00', '2025-11-11 14:00:00+00'), ('22bbccdd-eeff-2233-4455-667788990011', '264cb457-c21d-47d0-b56e-1149b958d625', 'Jane Smith', '高品質日本廚刀', '需要專業級別的日本廚刀用於我的餐廳。尋找正宗品牌如Shun或Global。', '["專業級別","正宗日本品牌","偏好碳鋼","8-10英吋主廚刀"]', 'home', '150.00', '500.00', 'HKD', 'jp', 'personal_handoff', 'Tokyo, Japan - Tsukiji Market area', 'Hong Kong', 'Hong Kong', '{"end":5,"unit":"days","start":3}', '{}', '["https://cdn.shopify.com/s/files/1/0437/4950/7224/files/high_quality.jpg?v=1680151742"]', 'active', 'medium', '[]', '2025-10-02 14:30:00+00', '2025-10-02 14:30:00+00'), ('33ccddee-ffaa-3344-5566-778899001122', '01debdb5-7784-439f-870c-37ea485042bc', 'Emily Johnson', '韓國護膚套裝 - 水光肌護理', '尋找完整的韓國護膚程序來達到水光肌效果。需要來自知名韓妝品牌的產品。', '["完整護理套裝","適合敏感肌","熱門韓妝品牌","專注水光肌的產品"]', 'beauty', '80.00', '200.00', 'HKD', 'kr', 'personal_handoff', 'Seoul, South Korea - Myeongdong', 'New York, NY', 'New York, NY', '{"end":6,"unit":"days","start":4}', '{"city":"New York","state":"NY","country":"USA","fullName":"Emily Johnson","postalCode":"10001","addressLine1":"456 Broadway","addressLine2":""}', '["https://www.lakinza.ca/cdn/shop/files/glass-skin-5-step-korean-skincare-routine-korean-skincare-127752.jpg?v=1729769277"]', 'active', 'low', '[]', '2025-10-03 09:15:00+00', '2025-10-03 09:15:00+00'), ('44ddeeff-aabb-4455-6677-889900112233', '264cb457-c21d-47d0-b56e-1149b958d625', 'Michael Wilson', '英國復古樂隊T恤', '收集復古樂隊T恤，特別是英國搖滾樂隊的。尋找80-90年代的正宗復古單品。', '["僅正宗復古","80-90年代","英國搖滾樂隊","狀態良好","中碼或大碼"]', 'fashion', '30.00', '150.00', 'HKD', 'uk', 'personal_handoff', 'London, UK - Camden Market', 'Toronto, Canada', 'Toronto, Canada', '{"end":9,"unit":"days","start":7}', '{"city":"Toronto","state":"ON","country":"Canada","fullName":"Mike Wilson","postalCode":"M6J 1G1","addressLine1":"789 Queen St W","addressLine2":"Unit 12"}', '["https://m.media-amazon.com/images/I/71BMG3GYIWL._UY1000_.jpg","https://m.media-amazon.com/images/I/812ZYZGgU0L._UY1000_.jpg"]', 'active', 'medium', '[]', '2025-10-04 16:45:00+00', '2025-10-04 16:45:00+00'), ('55eeffaa-bbcc-5566-7788-990011223344', '01debdb5-7784-439f-870c-37ea485042bc', 'Alex Chen', '德國機械鍵盤', '需要一把高端的德國機械鍵盤用於編程。對Cherry MX軸和優質構造品質感興趣。', '["Cherry MX軸","德國工藝","優質構造品質","無數字鍵盤或全尺寸","RGB燈光可選"]', 'electronics', '200.00', '400.00', 'HKD', 'de', 'personal_handoff', 'Berlin, Germany - Tech stores', 'San Francisco, CA', 'San Francisco, CA', '{"end":12,"unit":"days","start":10}', '{"city":"San Francisco","state":"CA","country":"USA","fullName":"Alex Chen","postalCode":"94105","addressLine1":"321 Tech Blvd","addressLine2":"Floor 5"}', '["https://cdn.sandberg.world/products/3d_html/640-31/640-31-800-01-01.jpg","https://m.media-amazon.com/images/I/71BkXYRAhoL._UF1000,1000_QL80_.jpg"]', 'active', 'high', '[]', '2025-10-05 11:20:00+00', '2025-10-05 11:20:00+00'), ('66ffaabb-ccdd-6677-8899-001122334455', '264cb457-c21d-47d0-b56e-1149b958d625', 'Sarah Liu', '瑞士手錶零件和工具', '尋找正宗的瑞士手錶維修工具和替換零件。需要用於古董手錶修復的精密儀器。', '["瑞士製造工具","精密儀器","古董手錶零件","專業級別","正宗組件"]', 'jewelry', '100.00', '600.00', 'HKD', 'ch', 'personal_handoff', 'Geneva, Switzerland - Watch district', 'Miami, FL', 'Miami, FL', '{"end":15,"unit":"days","start":13}', '{}', '["https://monochrome-watches.com/wp-content/uploads/2018/07/Inside-Vaucher-Manufacture-Fleurier-%E2%80%93-How-Exactly-Watch-Parts-Are-Manufactured-9.jpg","https://monochrome-watches.com/wp-content/uploads/2018/07/Inside-Vaucher-Manufacture-Fleurier-%E2%80%93-How-Exactly-Watch-Parts-Are-Manufactured-7.jpg"]', 'active', 'medium', '[]', '2025-10-06 13:00:00+00', '2025-10-06 13:00:00+00'), ('77aabbcc-ddee-7788-9900-112233445566', '01debdb5-7784-439f-870c-37ea485042bc', 'David Brown', '傳統中國書法毛筆', '尋找高品質傳統中國書法毛筆和硯台用於藝術練習。偏好手工製品。', '["手工毛筆","傳統材料","各種毛筆尺寸","包含硯台","正宗工藝"]', 'stationery', '40.00', '120.00', 'HKD', 'cn', 'personal_handoff', 'Beijing, China - Art supply district', 'Vancouver, Canada', 'Vancouver, Canada', '{"end":18,"unit":"days","start":16}', '{"city":"Vancouver","state":"BC","country":"Canada","fullName":"Sarah Liu","postalCode":"V6C 1X8","addressLine1":"654 Granville St","addressLine2":""}', '["https://artgoldenmaple.com/cdn/shop/files/2_e80b8166-9c7f-4cca-a277-e0bc43fae0d7.jpg?v=1711097345&width=1445"]', 'active', 'medium', '[]', '2025-10-07 08:30:00+00', '2025-10-07 08:30:00+00'), ('88bbccdd-eeff-8899-0011-223344556677', '264cb457-c21d-47d0-b56e-1149b958d625', 'Lisa Martinez', '澳洲戶外裝備', '計劃徒步旅行，需要優質的澳洲戶外裝備。尋找適合惡劣條件的耐用設備。', '["防紫外線","耐用材料","適合惡劣條件","徒步裝備","偏好澳洲品牌"]', 'sports', '150.00', '350.00', 'HKD', 'au', 'personal_handoff', 'Sydney, Australia - Outdoor gear shops', 'Denver, CO', 'Denver, CO', '{"end":21,"unit":"days","start":19}', '{}', '["https://hikeausnz.com/wp-content/uploads/2019/12/bluegum_lrg__40260.1382312491.1280.1280.jpg","https://hikeausnz.com/wp-content/uploads/2019/12/HikeAusNZ-update.jpg"]', 'active', 'medium', '[]', '2025-10-08 15:45:00+00', '2025-10-08 15:45:00+00'), ('8fde5281-4974-4381-b5ab-8993e01027c8', 'e4dc0e2c-7864-4c92-b450-b6dbd87b4071', 'friday626', '全新 PS2 主機', '​ 全新PlayStation 2 配備數據機連接埠和網路遊戲的整合式乙太網路連接埠,為設計和功能建立了新的標準。 功能和細節. 特色. DualShock 控制器; DVD 播放; 數位環繞音效', '["全新","未開盒"]', 'electronics', '1000.00', '2000.00', 'HKD', 'jp', 'personal_handoff', '香港', '沙田新城市廣場', null, '{"end":"14","unit":"days","start":"7"}', null, '["https://cdn11.bigcommerce.com/s-ymgqt/images/stencil/1000w/products/36541/25041/PS2_in_box__39849.1643918849.jpg?c=2"]', 'active', 'normal', '[]', '2025-11-15 04:23:07.002+00', '2025-11-15 04:23:07.002+00'), ('99ccddee-ffaa-9900-1122-334455667788', '01debdb5-7784-439f-870c-37ea485042bc', 'John Doe', '法國美食烹飪食材', '尋找正宗的法國美食食材用於特別晚餐。需要松露油、精美奶酪和特色香料。', '["正宗法國產品","美食品質","松露產品","手工奶酪","特色香料"]', 'food', '80.00', '250.00', 'HKD', 'fr', 'personal_handoff', 'Paris, France - Gourmet food markets', 'Chicago, IL', 'Chicago, IL', '{"end":24,"unit":"days","start":22}', '{"city":"Chicago","state":"IL","country":"USA","fullName":"David Brown","postalCode":"60601","addressLine1":"987 Culinary Ave","addressLine2":"Suite 3C"}', '["https://www.foodandwine.com/thmb/WBos4rhEqcP1pH1TBt3qU7lP--4=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Smoked-Salmon-Lyonnaise-Salad-FT-MAG-RECIPE-1224-81a86adbf03c421f8c3ef736795d7a7c.jpg"]', 'active', 'high', '[]', '2025-10-09 12:15:00+00', '2025-10-09 12:15:00+00'), ('aaddeeff-aabb-aa11-2233-445566778899', '264cb457-c21d-47d0-b56e-1149b958d625', 'Jane Smith', '意大利皮具包袋和配飾', '尋找正宗的意大利皮具。對來自佛羅倫薩的手工包袋、錢包和配飾感興趣。', '["正宗意大利皮革","手工製品","佛羅倫薩工匠","各種配飾","優質品質"]', 'fashion', '120.00', '400.00', 'HKD', 'it', 'personal_handoff', 'Florence, Italy - Leather workshops', 'Boston, MA', 'Boston, MA', '{"end":27,"unit":"days","start":25}', '{"city":"Boston","state":"MA","country":"USA","fullName":"Lisa Martinez","postalCode":"02116","addressLine1":"147 Beacon St","addressLine2":"Apt 8A"}', '["https://www.misuri.com/media/blog/misuri-leather-bags.jpg"]', 'active', 'medium', '[]', '2025-10-10 14:00:00+00', '2025-10-10 14:00:00+00'), ('b3aab2b6-ffb4-4c14-8d06-e591fdd595d7', 'e4dc0e2c-7864-4c92-b450-b6dbd87b4071', 'friday626', ' jELLYCAT|Pair of Marshmallows Bag Charm微笑棉花糖鎖匙扣', 'jELLYCAT 微笑棉花糖鎖匙扣
Amuseables Pair of Marshmallows Bag Charm 15cm', '["正版","全新"]', 'toys', '100.00', '300.00', 'HKD', '', 'personal_handoff', '香港', '尖沙咀', null, '{"end":"14","unit":"days","start":"7"}', null, '["https://www.babyonline.com.hk/image/cache/data/product/jellycat/2023-2/jellycat-670983144192-1-1200x1200.jpg"]', 'active', 'normal', '[]', '2025-11-15 04:39:30.175+00', '2025-11-15 04:39:30.175+00'), ('bbccddef-fabb-bb22-3344-556677889911', '01debdb5-7784-439f-870c-37ea485042bc', 'John Doe', 'Taylor Swift演唱會門票', '尋找泰勒絲香港演唱會的門票。需要好座位，最好是搖滾區或VIP區域。', '["正品門票","搖滾區或VIP","香港場次","連續座位","可轉讓"]', 'tickets', '800.00', '2500.00', 'HKD', 'hk', 'personal_handoff', 'Hong Kong - 亞洲國際博覽館', 'Hong Kong', 'Hong Kong', '{"end":3,"unit":"days","start":1}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"John Doe","postalCode":"","addressLine1":"Central District","addressLine2":""}', '["https://media.timeout.com/images/105878143/750/422/image.jpg"]', 'active', 'high', '[]', '2025-11-11 09:00:00+00', '2025-11-11 09:00:00+00'), ('ccddeeff-fabc-cc33-4455-667788990022', '264cb457-c21d-47d0-b56e-1149b958d625', 'Jane Smith', 'BTS世界巡演演唱會門票', '需要防彈少年團世界巡演首爾場次的門票。希望能找到合理價格的好座位。', '["官方門票","首爾場次","站席或座席皆可","合理價格","快速交付"]', 'tickets', '600.00', '1800.00', 'HKD', 'kr', 'personal_handoff', 'Seoul, South Korea - KSPO Dome', 'Hong Kong', 'Hong Kong', '{"end":5,"unit":"days","start":3}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Jane Smith","postalCode":"","addressLine1":"Tsim Sha Tsui","addressLine2":""}', '["https://dimg04.tripcdn.com/images/1mj4b12000iqfpqge5BB9_C_800_600_R5.jpg_.webp?proc=autoorient&proc=source%2Ftrip","https://res.klook.com/image/upload/v1738749994/fz38nrrnwnduqvxr0bdz.jpg"]', 'active', 'high', '[]', '2025-11-12 10:30:00+00', '2025-11-12 10:30:00+00'), ('ddeeffaa-fbcd-dd44-5566-778899001133', '01debdb5-7784-439f-870c-37ea485042bc', 'Emily Johnson', '謝霆鋒啟德演唱會2025', '尋找謝霆鋒啟德演唱會2025演唱會門票，台北場次。喜歡他的音樂很久了，希望能親自觀看演出。', '["謝霆鋒啟德演唱會2025","台北場次","任何座位區域","正品保證","電子或實體票皆可"]', 'tickets', '500.00', '1500.00', 'HKD', 'tw', 'personal_handoff', 'Taipei, Taiwan - 台北小巨蛋', 'Hong Kong', 'Hong Kong', '{"end":7,"unit":"days","start":5}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Emily Johnson","postalCode":"","addressLine1":"Wan Chai","addressLine2":""}', '["https://www.tickethk.com/timthumb.php?w=1000&src=images/posters/1668.jpg&v=90800-7b83"]', 'active', 'medium', '[]', '2025-11-13 15:20:00+00', '2025-11-13 15:20:00+00'), ('eeffaabb-fcde-ee55-6677-889900112244', '264cb457-c21d-47d0-b56e-1149b958d625', 'Michael Wilson', 'Coldplay演唱會門票', '尋找酷玩樂團倫敦溫布利體育場演唱會門票。想要體驗他們著名的現場表演氛圍。', '["溫布利體育場","倫敦場次","站席區優先","氣氛體驗佳","合理價位"]', 'tickets', '700.00', '2000.00', 'HKD', 'uk', 'personal_handoff', 'London, UK - Wembley Stadium', 'Hong Kong', 'Hong Kong', '{"end":10,"unit":"days","start":8}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Michael Wilson","postalCode":"","addressLine1":"Causeway Bay","addressLine2":""}', '["https://image-cdn.hypb.st/https%3A%2F%2Fhk.hypebeast.com%2Ffiles%2F2023%2F05%2Fcoldplay-2023-asia-tour-kaohsiung-tickets-release-info-1.jpeg?q=75&w=800&cbr=1&fit=max"]', 'active', 'medium', '[]', '2025-11-14 11:45:00+00', '2025-11-14 11:45:00+00'), ('fae61ed0-9e16-4c4e-90f8-cf9bac535511', 'e4dc0e2c-7864-4c92-b450-b6dbd87b4071', 'friday626', 'Cole Haan小白鞋', ' 女士ZERØGRAND City X-Trainer 運動鞋', '["UK 6","白色","香港"]', 'fashion', '400.00', '600.00', 'HKD', 'us', 'personal_handoff', '香港', '香港南區深灣道559號', null, '{"end":"14","unit":"days","start":"7"}', null, '["https://qmgrwxwtvddzidzrlrrn.supabase.co/storage/v1/object/public/uploads/request-images/e4dc0e2c-7864-4c92-b450-b6dbd87b4071-1763200046616-cuamgqb8b2s.png","https://qmgrwxwtvddzidzrlrrn.supabase.co/storage/v1/object/public/uploads/request-images/e4dc0e2c-7864-4c92-b450-b6dbd87b4071-1763200048810-5n7tlhzdiq.png"]', 'active', 'normal', '[]', '2025-11-15 09:47:30.107+00', '2025-11-15 09:47:30.107+00'), ('ff112233-4455-6677-8899-aabbccddeeff', '01debdb5-7784-439f-870c-37ea485042bc', 'Alice Wong', '高效清潔劑', '尋找一款高效的環保清潔劑，適合家庭日常使用。', '["環保材料","無毒無害","適合多種表面","大容量"]', 'home', '30.00', '80.00', 'HKD', 'cn', 'personal_handoff', 'Shanghai, China - Household Supplies Market', 'Hong Kong', 'Hong Kong', '{"end":5,"unit":"days","start":3}', '{"city":"Hong Kong","state":"","country":"HKG","fullName":"Alice Wong","postalCode":"","addressLine1":"Kowloon","addressLine2":""}', '["https://img.myshopline.com/image/store/1716278620360/Home-A10194-00500.jpeg?w=2000&h=2000"]', 'active', 'medium', '[]', '2025-11-11 12:00:00+00', '2025-11-11 12:00:00+00');